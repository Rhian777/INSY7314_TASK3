{"ast":null,"code":"// frontend/src/auth.js\n\nconst TOKEN_KEY = \"insy_token\";\n\n/**\r\n * Save JWT token to localStorage\r\n */\nexport function saveToken(token) {\n  if (!token) return;\n  localStorage.setItem(TOKEN_KEY, token);\n}\n\n/**\r\n * Load JWT token from localStorage\r\n */\nexport function loadToken() {\n  return localStorage.getItem(TOKEN_KEY);\n}\n\n/**\r\n * Remove stored token (logout)\r\n */\nexport function clearToken() {\n  localStorage.removeItem(TOKEN_KEY);\n}\n\n/**\r\n * Check if user is logged in (and optionally if token is still valid)\r\n */\nexport function isLoggedIn() {\n  const token = loadToken();\n  if (!token) return false;\n  try {\n    // Decode JWT payload (without verification)\n    const payload = JSON.parse(atob(token.split(\".\")[1]));\n    const isExpired = payload.exp * 1000 < Date.now();\n    if (isExpired) {\n      clearToken();\n      return false;\n    }\n    return true;\n  } catch {\n    clearToken();\n    return false;\n  }\n}\n\n/**\r\n * Get decoded user info (optional helper)\r\n * Returns { id, role, exp, iat } if available\r\n */\nexport function getUserInfo() {\n  const token = loadToken();\n  if (!token) return null;\n  try {\n    return JSON.parse(atob(token.split(\".\")[1]));\n  } catch {\n    return null;\n  }\n}\n\n/*const TOKEN_KEY = \"insy_token\";\r\nexport function saveToken(token) {\r\n  localStorage.setItem(TOKEN_KEY, token);\r\n}\r\nexport function loadToken() {\r\n  return localStorage.getItem(TOKEN_KEY);\r\n}\r\nexport function clearToken() {\r\n  localStorage.removeItem(TOKEN_KEY);\r\n}\r\nexport function isLoggedIn() {\r\n  return !!loadToken();\r\n}*/","map":{"version":3,"names":["TOKEN_KEY","saveToken","token","localStorage","setItem","loadToken","getItem","clearToken","removeItem","isLoggedIn","payload","JSON","parse","atob","split","isExpired","exp","Date","now","getUserInfo"],"sources":["C:/Users/lab_services_student/Documents/INSY7314_POE_TASK3/frontend/src/auth.js"],"sourcesContent":["// frontend/src/auth.js\r\n\r\nconst TOKEN_KEY = \"insy_token\";\r\n\r\n/**\r\n * Save JWT token to localStorage\r\n */\r\nexport function saveToken(token) {\r\n  if (!token) return;\r\n  localStorage.setItem(TOKEN_KEY, token);\r\n}\r\n\r\n/**\r\n * Load JWT token from localStorage\r\n */\r\nexport function loadToken() {\r\n  return localStorage.getItem(TOKEN_KEY);\r\n}\r\n\r\n/**\r\n * Remove stored token (logout)\r\n */\r\nexport function clearToken() {\r\n  localStorage.removeItem(TOKEN_KEY);\r\n}\r\n\r\n/**\r\n * Check if user is logged in (and optionally if token is still valid)\r\n */\r\nexport function isLoggedIn() {\r\n  const token = loadToken();\r\n  if (!token) return false;\r\n\r\n  try {\r\n    // Decode JWT payload (without verification)\r\n    const payload = JSON.parse(atob(token.split(\".\")[1]));\r\n    const isExpired = payload.exp * 1000 < Date.now();\r\n    if (isExpired) {\r\n      clearToken();\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch {\r\n    clearToken();\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Get decoded user info (optional helper)\r\n * Returns { id, role, exp, iat } if available\r\n */\r\nexport function getUserInfo() {\r\n  const token = loadToken();\r\n  if (!token) return null;\r\n  try {\r\n    return JSON.parse(atob(token.split(\".\")[1]));\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\n\r\n/*const TOKEN_KEY = \"insy_token\";\r\nexport function saveToken(token) {\r\n  localStorage.setItem(TOKEN_KEY, token);\r\n}\r\nexport function loadToken() {\r\n  return localStorage.getItem(TOKEN_KEY);\r\n}\r\nexport function clearToken() {\r\n  localStorage.removeItem(TOKEN_KEY);\r\n}\r\nexport function isLoggedIn() {\r\n  return !!loadToken();\r\n}*/\r\n"],"mappings":"AAAA;;AAEA,MAAMA,SAAS,GAAG,YAAY;;AAE9B;AACA;AACA;AACA,OAAO,SAASC,SAASA,CAACC,KAAK,EAAE;EAC/B,IAAI,CAACA,KAAK,EAAE;EACZC,YAAY,CAACC,OAAO,CAACJ,SAAS,EAAEE,KAAK,CAAC;AACxC;;AAEA;AACA;AACA;AACA,OAAO,SAASG,SAASA,CAAA,EAAG;EAC1B,OAAOF,YAAY,CAACG,OAAO,CAACN,SAAS,CAAC;AACxC;;AAEA;AACA;AACA;AACA,OAAO,SAASO,UAAUA,CAAA,EAAG;EAC3BJ,YAAY,CAACK,UAAU,CAACR,SAAS,CAAC;AACpC;;AAEA;AACA;AACA;AACA,OAAO,SAASS,UAAUA,CAAA,EAAG;EAC3B,MAAMP,KAAK,GAAGG,SAAS,CAAC,CAAC;EACzB,IAAI,CAACH,KAAK,EAAE,OAAO,KAAK;EAExB,IAAI;IACF;IACA,MAAMQ,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACX,KAAK,CAACY,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACrD,MAAMC,SAAS,GAAGL,OAAO,CAACM,GAAG,GAAG,IAAI,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;IACjD,IAAIH,SAAS,EAAE;MACbR,UAAU,CAAC,CAAC;MACZ,OAAO,KAAK;IACd;IACA,OAAO,IAAI;EACb,CAAC,CAAC,MAAM;IACNA,UAAU,CAAC,CAAC;IACZ,OAAO,KAAK;EACd;AACF;;AAEA;AACA;AACA;AACA;AACA,OAAO,SAASY,WAAWA,CAAA,EAAG;EAC5B,MAAMjB,KAAK,GAAGG,SAAS,CAAC,CAAC;EACzB,IAAI,CAACH,KAAK,EAAE,OAAO,IAAI;EACvB,IAAI;IACF,OAAOS,IAAI,CAACC,KAAK,CAACC,IAAI,CAACX,KAAK,CAACY,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC9C,CAAC,CAAC,MAAM;IACN,OAAO,IAAI;EACb;AACF;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}