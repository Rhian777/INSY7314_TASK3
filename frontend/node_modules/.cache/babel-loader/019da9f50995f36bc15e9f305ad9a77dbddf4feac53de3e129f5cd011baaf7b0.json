{"ast":null,"code":"const TOKEN_KEY = \"insy_token\";\nexport function saveToken(token) {\n  if (!token) return;\n  localStorage.setItem(TOKEN_KEY, token);\n}\nexport function loadToken() {\n  return localStorage.getItem(TOKEN_KEY);\n}\nexport function clearToken() {\n  localStorage.removeItem(TOKEN_KEY);\n}\nexport function isLoggedIn() {\n  const token = loadToken();\n  if (!token) return false;\n  try {\n    // Decode JWT payload\n    const payload = JSON.parse(atob(token.split(\".\")[1]));\n    const isExpired = payload.exp * 1000 < Date.now();\n    if (isExpired) {\n      clearToken();\n      return false;\n    }\n    return true;\n  } catch {\n    clearToken();\n    return false;\n  }\n}\nexport function getUserInfo() {\n  const token = loadToken();\n  if (!token) return null;\n  try {\n    return JSON.parse(atob(token.split(\".\")[1]));\n  } catch {\n    return null;\n  }\n}","map":{"version":3,"names":["TOKEN_KEY","saveToken","token","localStorage","setItem","loadToken","getItem","clearToken","removeItem","isLoggedIn","payload","JSON","parse","atob","split","isExpired","exp","Date","now","getUserInfo"],"sources":["C:/Users/lab_services_student/Documents/INSY7314_POE_TASK3/frontend/src/auth.js"],"sourcesContent":["const TOKEN_KEY = \"insy_token\";\r\n\r\nexport function saveToken(token) {\r\n  if (!token) return;\r\n  localStorage.setItem(TOKEN_KEY, token);\r\n}\r\n\r\nexport function loadToken() {\r\n  return localStorage.getItem(TOKEN_KEY);\r\n}\r\n\r\nexport function clearToken() {\r\n  localStorage.removeItem(TOKEN_KEY);\r\n}\r\n\r\nexport function isLoggedIn() {\r\n  const token = loadToken();\r\n  if (!token) return false;\r\n\r\n  try {\r\n    // Decode JWT payload\r\n    const payload = JSON.parse(atob(token.split(\".\")[1]));\r\n    const isExpired = payload.exp * 1000 < Date.now();\r\n    if (isExpired) {\r\n      clearToken();\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch {\r\n    clearToken();\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function getUserInfo() {\r\n  const token = loadToken();\r\n  if (!token) return null;\r\n  try {\r\n    return JSON.parse(atob(token.split(\".\")[1]));\r\n  } catch {\r\n    return null;\r\n  }\r\n}"],"mappings":"AAAA,MAAMA,SAAS,GAAG,YAAY;AAE9B,OAAO,SAASC,SAASA,CAACC,KAAK,EAAE;EAC/B,IAAI,CAACA,KAAK,EAAE;EACZC,YAAY,CAACC,OAAO,CAACJ,SAAS,EAAEE,KAAK,CAAC;AACxC;AAEA,OAAO,SAASG,SAASA,CAAA,EAAG;EAC1B,OAAOF,YAAY,CAACG,OAAO,CAACN,SAAS,CAAC;AACxC;AAEA,OAAO,SAASO,UAAUA,CAAA,EAAG;EAC3BJ,YAAY,CAACK,UAAU,CAACR,SAAS,CAAC;AACpC;AAEA,OAAO,SAASS,UAAUA,CAAA,EAAG;EAC3B,MAAMP,KAAK,GAAGG,SAAS,CAAC,CAAC;EACzB,IAAI,CAACH,KAAK,EAAE,OAAO,KAAK;EAExB,IAAI;IACF;IACA,MAAMQ,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACX,KAAK,CAACY,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACrD,MAAMC,SAAS,GAAGL,OAAO,CAACM,GAAG,GAAG,IAAI,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;IACjD,IAAIH,SAAS,EAAE;MACbR,UAAU,CAAC,CAAC;MACZ,OAAO,KAAK;IACd;IACA,OAAO,IAAI;EACb,CAAC,CAAC,MAAM;IACNA,UAAU,CAAC,CAAC;IACZ,OAAO,KAAK;EACd;AACF;AAEA,OAAO,SAASY,WAAWA,CAAA,EAAG;EAC5B,MAAMjB,KAAK,GAAGG,SAAS,CAAC,CAAC;EACzB,IAAI,CAACH,KAAK,EAAE,OAAO,IAAI;EACvB,IAAI;IACF,OAAOS,IAAI,CAACC,KAAK,CAACC,IAAI,CAACX,KAAK,CAACY,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC9C,CAAC,CAAC,MAAM;IACN,OAAO,IAAI;EACb;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}